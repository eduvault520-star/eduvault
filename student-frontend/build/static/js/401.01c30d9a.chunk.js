"use strict";(self.webpackChunkeduvault_student_frontend=self.webpackChunkeduvault_student_frontend||[]).push([[401],{1401:(e,t,n)=>{n.r(t),n.d(t,{default:()=>de});var s=n(8),r=n(9950),i=n(4857),o=n(6491),a=n(6639),l=n(6157),c=n(899),d=n(1413),u=n(2053),x=n(5277),h=n(226),m=n(5333),p=n(2235),y=n(4745),g=n(6699),A=n(470),j=n(704),b=n(7497),v=n(6868),f=n(6986),w=n(5546),S=n(3464),k=n(8170),C=n(3505),P=n(8629),I=n(8602),E=n(7898),D=n(6163),R=n(6370),W=n(2974),z=n(7920),L=n(6191),U=n(3779),T=n(3297),M=n(6904),K=n(2092),B=n(4924),N=n(3553),F=n(1227),Y=n(5834),V=n(8429),q=n(9723),H=n(5926),_=n(4414);const O=function(e){let{filename:t,backendUrl:n,isPremium:s=!1,hasSubscription:i=!1}=e;console.log("\ud83c\udfa5 Student AuthenticatedVideo component rendered with:",{filename:t,backendUrl:n,isPremium:s,hasSubscription:i});const[l,c]=(0,r.useState)(null),[d,x]=(0,r.useState)(!0),[h,m]=(0,r.useState)(null);return(0,r.useEffect)(()=>{if(s&&!i)return m("Premium subscription required to access this content"),void x(!1);return(async()=>{try{x(!0);const e=localStorage.getItem("token");if(!e)throw new Error("Please log in to access this content");console.log("\ud83c\udfa5 Fetching video blob for student:",t);const s=await fetch("".concat(n,"/api/upload/file/").concat(t),{headers:{Authorization:"Bearer ".concat(e)},credentials:"include"});if(!s.ok){if(401===s.status)throw new Error("Please log in to access this content");if(403===s.status)throw new Error("You do not have permission to access this content");throw new Error("Error loading video: ".concat(s.status))}const r=await s.blob(),i=URL.createObjectURL(r);console.log("\ud83c\udfa5 Created student blob URL:",i),c(i)}catch(e){console.error("Error fetching video:",e),m(e.message)}finally{x(!1)}})(),()=>{l&&URL.revokeObjectURL(l)}},[t,n,s,i]),d?(0,_.jsx)(o.A,{sx:{display:"flex",alignItems:"center",justifyContent:"center",height:300,bgcolor:"grey.900",color:"white",borderRadius:2},children:(0,_.jsxs)(o.A,{sx:{textAlign:"center"},children:[(0,_.jsx)(a.A,{color:"primary",sx:{mb:2}}),(0,_.jsx)(u.A,{variant:"body2",children:"Loading video..."})]})}):h?(0,_.jsx)(o.A,{sx:{display:"flex",alignItems:"center",justifyContent:"center",height:300,bgcolor:"grey.900",color:"white",borderRadius:2,border:s?"2px solid #ffa726":"1px solid #666"},children:(0,_.jsxs)(o.A,{sx:{textAlign:"center",p:3},children:[(0,_.jsx)(C.A,{sx:{fontSize:64,mb:2,color:"grey.500"}}),(0,_.jsx)(u.A,{variant:"body2",color:"error",gutterBottom:!0,children:h}),s&&!i&&(0,_.jsx)(u.A,{variant:"caption",color:"warning.main",children:"\ud83d\udd12 Premium Content - Subscription Required"})]})}):(0,_.jsxs)(o.A,{sx:{position:"relative",borderRadius:2,overflow:"hidden",border:s?"2px solid #ffa726":"1px solid #ddd"},children:[s&&(0,_.jsx)(o.A,{sx:{position:"absolute",top:8,right:8,zIndex:10,bgcolor:"rgba(255, 167, 38, 0.9)",color:"white",px:1,py:.5,borderRadius:1,fontSize:"0.75rem",fontWeight:"bold"},children:"\u2b50 PREMIUM"}),(0,_.jsx)("video",{controls:!0,width:"100%",height:"300",style:{display:"block"},preload:"metadata",controlsList:"nodownload noremoteplayback",disablePictureInPicture:!0,disableRemotePlayback:!0,onContextMenu:e=>e.preventDefault(),onLoadStart:()=>console.log("\ud83c\udfa5 Student video loading started"),onCanPlay:()=>console.log("\ud83c\udfa5 Student video ready to play"),onError:e=>console.error("\ud83c\udfa5 Student video error:",e),src:l,children:"Your browser does not support the video tag."})]})};var G=n(33),J=n(3174),X=n(249),Q=n(4446),Z=n(4195),$=n(3563),ee=n(9925),te=n(9739),ne=n(5625);const se=e=>{let{open:t,onClose:n,courseId:s,courseName:i,year:l,onSubscriptionSuccess:c}=e;const[d,m]=(0,r.useState)(""),[p,g]=(0,r.useState)(!1),[A,j]=(0,r.useState)(""),[b,v]=(0,r.useState)(""),[f,w]=(0,r.useState)(!1),E=async e=>{let t=0;const n=async()=>{try{const r=(await H.A.get("/api/subscription/status/".concat(e))).data.subscription;if("completed"===r.status)return v("\ud83c\udf89 Payment successful! Your premium subscription is now active."),void setTimeout(()=>{c(r),D()},2e3);if("failed"===r.status)return j("\u274c Payment failed. Please try again or check your M-Pesa balance."),void w(!1);if(t>12)try{const t=(await H.A.get("/api/subscription/query/".concat(e))).data.subscription;if("completed"===t.status)return v("\ud83c\udf89 Payment confirmed! Your premium subscription is now active."),void setTimeout(()=>{c(t),D()},2e3);if("failed"===t.status)return j("\u274c Payment failed. Please try again."),void w(!1)}catch(s){console.log("Direct M-Pesa query failed, continuing with regular polling")}t++,t<36?setTimeout(n,1e4):(j("\u23f0 Payment timeout. If you completed the payment, please wait a few minutes and refresh the page."),w(!1))}catch(r){console.error("Error checking payment status:",r),t++,t<36?setTimeout(n,1e4):(j("Unable to verify payment status. Please contact support if payment was deducted."),w(!1))}};setTimeout(n,3e3)},D=()=>{m(""),j(""),v(""),w(!1),g(!1),n()};return(0,_.jsxs)(S.A,{open:t,onClose:D,maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{borderRadius:3}},children:[(0,_.jsxs)(G.A,{sx:{display:"flex",alignItems:"center",gap:2,bgcolor:"primary.main",color:"white"},children:[(0,_.jsx)(L.A,{}),(0,_.jsxs)(o.A,{children:[(0,_.jsx)(u.A,{variant:"h6",children:"Premium Subscription"}),(0,_.jsxs)(u.A,{variant:"caption",children:[i," - Year ",l]})]})]}),(0,_.jsxs)(k.A,{sx:{p:3},children:[A&&(0,_.jsx)(J.A,{severity:"error",sx:{mb:2},children:A}),b&&(0,_.jsx)(J.A,{severity:"success",sx:{mb:2},children:b}),f?(0,_.jsxs)(o.A,{sx:{textAlign:"center",py:4},children:[(0,_.jsx)(a.A,{size:60,sx:{mb:2}}),(0,_.jsx)(u.A,{variant:"h6",gutterBottom:!0,children:"Processing Payment..."}),(0,_.jsx)(u.A,{variant:"body2",color:"text.secondary",children:"Please check your phone for M-Pesa prompt and enter your PIN"})]}):(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)(o.A,{sx:{mb:3},children:[(0,_.jsxs)(u.A,{variant:"h5",sx:{fontWeight:"bold",mb:1},children:["KSH 100",(0,_.jsx)(u.A,{component:"span",variant:"body2",color:"text.secondary",sx:{ml:1},children:"/ month"})]}),(0,_.jsx)(x.A,{label:"1 Month Access",color:"primary",size:"small",sx:{mb:2}}),(0,_.jsxs)(u.A,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:["Get premium access to Year ",l," content for ",i]})]}),(0,_.jsx)(y.A,{sx:{my:2}}),(0,_.jsx)(u.A,{variant:"h6",gutterBottom:!0,children:"What's Included:"}),(0,_.jsxs)(X.A,{dense:!0,children:[(0,_.jsxs)(Q.Ay,{children:[(0,_.jsx)(Z.A,{children:(0,_.jsx)(C.A,{color:"primary"})}),(0,_.jsx)($.A,{primary:"Premium Video Lectures",secondary:"Stream high-quality lecture recordings"})]}),(0,_.jsxs)(Q.Ay,{children:[(0,_.jsx)(Z.A,{children:(0,_.jsx)(P.A,{color:"primary"})}),(0,_.jsx)($.A,{primary:"Downloadable Notes",secondary:"Download PDF notes for offline study"})]}),(0,_.jsxs)(Q.Ay,{children:[(0,_.jsx)(Z.A,{children:(0,_.jsx)(I.A,{color:"primary"})}),(0,_.jsx)($.A,{primary:"CATs & Past Exams",secondary:"Access to premium assessment materials"})]}),(0,_.jsxs)(Q.Ay,{children:[(0,_.jsx)(Z.A,{children:(0,_.jsx)(F.A,{color:"success"})}),(0,_.jsx)($.A,{primary:"Course-Specific Access",secondary:"Valid only for this course and year"})]})]}),(0,_.jsx)(y.A,{sx:{my:2}}),(0,_.jsx)(u.A,{variant:"h6",gutterBottom:!0,children:"M-Pesa Payment:"}),(0,_.jsx)(ee.A,{fullWidth:!0,label:"Phone Number",placeholder:"0712345678 or 254712345678",value:d,onChange:e=>m((e=>{const t=e.replace(/\D/g,"");return t.startsWith("254")?t:t.startsWith("0")?"254"+t.substring(1):t.startsWith("7")||t.startsWith("1")?"254"+t:t})(e.target.value)),helperText:"Enter your M-Pesa registered phone number",sx:{mb:2}}),(0,_.jsx)(J.A,{severity:"info",sx:{mb:2},children:(0,_.jsx)(u.A,{variant:"body2",children:"You will receive an M-Pesa prompt on your phone. Enter your M-Pesa PIN to complete the payment."})})]})]}),(0,_.jsxs)(te.A,{sx:{p:3,pt:0},children:[(0,_.jsx)(h.A,{onClick:D,disabled:p,children:"Cancel"}),!f&&(0,_.jsx)(h.A,{variant:"contained",onClick:async()=>{if(!d||d.length<10)j("Please enter a valid phone number");else try{g(!0),j("");const e=await H.A.post("/api/subscription/initiate",{courseId:s,year:parseInt(l),phoneNumber:d.replace(/\D/g,"")});w(!0),v("Payment request sent! Please check your phone for M-Pesa prompt and enter your PIN to complete the payment."),E(e.data.subscription.id)}catch(n){var e,t;j((null===(e=n.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||"Payment initiation failed")}finally{g(!1)}},disabled:p||!d,startIcon:p?(0,_.jsx)(a.A,{size:20}):(0,_.jsx)(ne.A,{}),sx:{minWidth:120},children:p?"Processing...":"Pay KSH 100"})]})]})};var re=n(6835);const ie=e=>{let{filename:t,contentType:n,title:s,backendUrl:i,preventScreenshot:a=!0,preventRecording:l=!0,onClose:c}=e;const d=(0,r.useRef)(null),[x,h]=(0,r.useState)(!1),[p,y]=(0,r.useState)(!1);(0,r.useEffect)(()=>((a||l)&&g(),()=>{A()}),[a,l]);const g=()=>{const e=e=>(e.preventDefault(),j(),!1),t=e=>"PrintScreen"===e.key||e.altKey&&"PrintScreen"===e.key||e.metaKey&&e.shiftKey&&"S"===e.key||e.ctrlKey&&e.shiftKey&&"S"===e.key||"F12"===e.key||e.ctrlKey&&e.shiftKey&&"I"===e.key||e.ctrlKey&&e.shiftKey&&"J"===e.key||e.ctrlKey&&"U"===e.key?(e.preventDefault(),j(),!1):void 0,n=()=>{document.hidden&&l?(d.current&&(d.current.style.filter="blur(20px)"),j("Screen recording detected! Content has been blurred for security.")):d.current&&(d.current.style.filter="none")};document.addEventListener("contextmenu",e),document.addEventListener("keydown",t),document.addEventListener("visibilitychange",n),d.current&&(d.current.style.userSelect="none",d.current.style.webkitUserSelect="none",d.current.style.mozUserSelect="none",d.current.style.msUserSelect="none"),navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia&&j("Screen capture capabilities detected. Recording is prohibited."),window.securityCleanup=()=>{document.removeEventListener("contextmenu",e),document.removeEventListener("keydown",t),document.removeEventListener("visibilitychange",n)},h(!0)},A=()=>{window.securityCleanup&&(window.securityCleanup(),delete window.securityCleanup),h(!1)},j=e=>{if(!p){y(!0);alert("\ud83d\udd12 SECURITY NOTICE: ".concat(e||"Screenshots and screen recording are prohibited for this content.")),setTimeout(()=>y(!1),5e3)}},b=()=>{const e=localStorage.getItem("token");return"".concat(i,"/api/upload/file/").concat(t,"?token=").concat(encodeURIComponent(e))};return(0,_.jsxs)(o.A,{ref:d,sx:{position:"relative",width:"100%",height:"100%",minHeight:400,border:"2px solid #f44336",borderRadius:2,overflow:"hidden",bgcolor:"black","&::before":a?{content:'""',position:"absolute",top:0,left:0,right:0,bottom:0,background:"repeating-linear-gradient(45deg, transparent, transparent 10px, rgba(244, 67, 54, 0.1) 10px, rgba(244, 67, 54, 0.1) 20px)",pointerEvents:"none",zIndex:10}:{}},children:[(0,_.jsxs)(o.A,{sx:{position:"absolute",top:0,left:0,right:0,bgcolor:"rgba(244, 67, 54, 0.9)",color:"white",p:1,display:"flex",alignItems:"center",justifyContent:"space-between",zIndex:20},children:[(0,_.jsxs)(o.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,_.jsx)(N.A,{fontSize:"small"}),(0,_.jsx)(u.A,{variant:"caption",sx:{fontWeight:"bold"},children:"\ud83d\udd12 SECURE CONTENT - Screenshots & Recording Prohibited"})]}),c&&(0,_.jsx)(m.A,{size:"small",onClick:c,sx:{color:"white"},children:(0,_.jsx)(re.A,{fontSize:"small"})})]}),(0,_.jsxs)(o.A,{sx:{pt:6,height:"100%"},children:["pdf"===n&&(0,_.jsx)("iframe",{src:b(),width:"100%",height:"100%",style:{border:"none",display:"block"},title:s,onContextMenu:e=>e.preventDefault()}),"image"===n&&(0,_.jsx)(o.A,{sx:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",p:2},children:(0,_.jsx)("img",{src:b(),alt:s,style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"},onContextMenu:e=>e.preventDefault(),draggable:!1})})]}),(0,_.jsx)(o.A,{sx:{position:"absolute",bottom:10,right:10,bgcolor:"rgba(0, 0, 0, 0.7)",color:"white",p:1,borderRadius:1,fontSize:"0.75rem",zIndex:20,pointerEvents:"none"},children:"\ud83d\udd12 EduVault Secure View"}),x&&(0,_.jsx)(J.A,{severity:"warning",sx:{position:"absolute",bottom:10,left:10,right:60,zIndex:20,fontSize:"0.75rem"},children:"This content is protected. Screenshots and screen recording are disabled."})]})};var oe=n(8785),ae=n(8179),le=n(1543);const ce=e=>{let{type:t,id:n,onClose:i,open:l=!1}=e;const{user:c}=(0,le.A)(),[d,m]=(0,r.useState)(!0),[p,g]=(0,r.useState)(null),[b,v]=(0,r.useState)(""),[f,w]=(0,r.useState)(""),[C,P]=(0,r.useState)(!1),[I,E]=(0,r.useState)(0),[D,R]=(0,r.useState)(""),[W,z]=(0,r.useState)(!1),L=((0,r.useRef)(null),(0,r.useRef)(null)),U=(0,r.useRef)(null);(0,r.useEffect)(()=>(l&&t&&n&&(T(),M()),()=>{K()}),[t,n,l]),(0,r.useEffect)(()=>(C&&I>0&&(L.current=setInterval(()=>{E(e=>e<=1?(F(),0):e-1)},1e3)),()=>{L.current&&clearInterval(L.current)}),[C,I]);const T=async()=>{try{m(!0),w(""),console.log("\ud83d\udd0d SecureImageViewer - Fetching assessment:",{type:t,id:n});const e=await H.A.get("/api/secure-images/metadata/".concat(t,"/").concat(n));e.data.success?(g(e.data.data),E(60*e.data.data.duration)):w("Assessment not found or access denied")}catch(f){console.error("Error fetching assessment:",f),w("Failed to load assessment. Please check your connection and try again.")}finally{m(!1)}},M=()=>{const e=e=>{e.preventDefault(),B("Right-click is disabled for security reasons")},t=e=>"PrintScreen"===e.key||e.altKey&&"PrintScreen"===e.key||e.metaKey&&"PrintScreen"===e.key||e.ctrlKey&&"PrintScreen"===e.key?(e.preventDefault(),B("Screenshots are not allowed during assessment viewing"),!1):"F12"===e.key||e.ctrlKey&&e.shiftKey&&"I"===e.key||e.ctrlKey&&e.shiftKey&&"J"===e.key?(e.preventDefault(),B("Developer tools are disabled for security"),!1):e.ctrlKey&&"u"===e.key?(e.preventDefault(),B("View source is disabled for security"),!1):e.ctrlKey&&"s"===e.key?(e.preventDefault(),B("Saving is not allowed during assessment"),!1):e.ctrlKey&&"a"===e.key?(e.preventDefault(),B("Text selection is disabled for security"),!1):e.ctrlKey&&"c"===e.key?(e.preventDefault(),B("Copying is not allowed during assessment"),!1):void 0,n=e=>{e.preventDefault(),B("Drag and drop is disabled for security")},s=e=>{e.preventDefault()};document.addEventListener("contextmenu",e),document.addEventListener("keydown",t),document.addEventListener("dragstart",n),document.addEventListener("selectstart",s),window.securityListeners={handleContextMenu:e,handleKeyDown:t,handleDragStart:n,handleSelectStart:s};const r=()=>{C&&B("Please stay focused on the assessment window")},i=()=>{document.hidden&&C&&B("Assessment paused - window is not visible")};window.addEventListener("blur",r),document.addEventListener("visibilitychange",i),window.securityListeners.handleBlur=r,window.securityListeners.handleVisibilityChange=i;let o={open:!1,orientation:null};setInterval(()=>{window.outerHeight-window.innerHeight>160||window.outerWidth-window.innerWidth>160?o.open||(o.open=!0,B("Developer tools detected - please close them")):o.open=!1},500)},K=()=>{if(window.securityListeners){const{handleContextMenu:e,handleKeyDown:t,handleDragStart:n,handleSelectStart:s,handleBlur:r,handleVisibilityChange:i}=window.securityListeners;document.removeEventListener("contextmenu",e),document.removeEventListener("keydown",t),document.removeEventListener("dragstart",n),document.removeEventListener("selectstart",s),window.removeEventListener("blur",r),document.removeEventListener("visibilitychange",i),delete window.securityListeners}L.current&&clearInterval(L.current),b&&b.startsWith("blob:")&&URL.revokeObjectURL(b)},B=e=>{R(e),z(!0)},F=()=>{B("\u23f0 Time is up! The assessment viewing session has ended."),setTimeout(()=>{Y()},3e3)},Y=async()=>{try{await H.A.post("/api/secure-images/log-access",{assessmentId:n,assessmentType:t,action:"end_viewing",timestamp:(new Date).toISOString()})}catch(f){console.error("Error logging end of session:",f)}K(),P(!1),v(""),i&&i()};return l?d?(0,_.jsx)(S.A,{open:!0,maxWidth:"md",fullWidth:!0,children:(0,_.jsx)(k.A,{children:(0,_.jsxs)(o.A,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"200px",children:[(0,_.jsx)(a.A,{}),(0,_.jsx)(u.A,{sx:{ml:2},children:"Loading secure assessment..."})]})})}):f?(0,_.jsxs)(S.A,{open:!0,maxWidth:"sm",fullWidth:!0,children:[(0,_.jsx)(G.A,{children:"Error"}),(0,_.jsx)(k.A,{children:(0,_.jsx)(J.A,{severity:"error",children:f})}),(0,_.jsx)(te.A,{children:(0,_.jsx)(h.A,{onClick:i,children:"Close"})})]}):(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)(S.A,{open:!0,maxWidth:"lg",fullWidth:!0,fullScreen:C,onClose:C?void 0:i,disableEscapeKeyDown:C,PaperProps:{sx:(0,s.A)({},C&&{bgcolor:"black",color:"white"})},children:[(0,_.jsxs)(G.A,{sx:{bgcolor:C?"rgba(0,0,0,0.9)":"error.light",color:C?"white":"error.dark",display:"flex",alignItems:"center",gap:1},children:[(0,_.jsx)(N.A,{}),"\ud83d\udd12 Secure Assessment Viewer",C&&(0,_.jsx)(x.A,{label:"Time: ".concat((e=>{const t=Math.floor(e/3600),n=Math.floor(e%3600/60),s=e%60;return t>0?"".concat(t,":").concat(n.toString().padStart(2,"0"),":").concat(s.toString().padStart(2,"0")):"".concat(n,":").concat(s.toString().padStart(2,"0"))})(I)),color:I<300?"error":"primary",sx:{ml:"auto"}}),C&&(0,_.jsx)(h.A,{variant:"contained",color:"error",onClick:Y,size:"small",startIcon:(0,_.jsx)(re.A,{}),children:"End Session"})]}),(0,_.jsx)(k.A,{sx:{p:0},children:C?(0,_.jsxs)(o.A,{sx:{height:"100vh",display:"flex",flexDirection:"column",bgcolor:"black",position:"relative",userSelect:"none",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none"},children:[(0,_.jsx)(o.A,{sx:{position:"absolute",top:0,left:0,right:0,bottom:0,pointerEvents:"none",zIndex:1e3,background:"\n                  repeating-linear-gradient(\n                    45deg,\n                    transparent,\n                    transparent 10px,\n                    rgba(255,0,0,0.05) 10px,\n                    rgba(255,0,0,0.05) 11px\n                  )\n                "}}),(0,_.jsx)(o.A,{sx:{flex:1,display:"flex",justifyContent:"center",alignItems:"center",p:2,userSelect:"none",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none"},children:b?(0,_.jsx)("img",{ref:U,src:b,alt:"Assessment",style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain",userSelect:"none",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",pointerEvents:"none",WebkitUserDrag:"none",WebkitTouchCallout:"none",filter:"contrast(1.1) brightness(0.95)"},onDragStart:e=>e.preventDefault(),onContextMenu:e=>e.preventDefault(),onLoad:()=>{U.current&&(U.current.style.webkitUserSelect="none",U.current.style.webkitTouchCallout="none")}}):(0,_.jsx)(a.A,{color:"primary"})}),(0,_.jsxs)(o.A,{sx:{position:"absolute",bottom:20,right:20,color:"rgba(255,255,255,0.3)",fontSize:"12px",zIndex:1001,pointerEvents:"none"},children:["\ud83d\udd12 Secure View - ",null===c||void 0===c?void 0:c.firstName," ",null===c||void 0===c?void 0:c.lastName," - ",(new Date).toLocaleString()]}),(0,_.jsx)(o.A,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:"rgba(255,255,255,0.1)",fontSize:"48px",zIndex:999,pointerEvents:"none",fontWeight:"bold"},children:"EDUVAULT"})]}):(0,_.jsxs)(o.A,{sx:{p:3},children:[(0,_.jsx)(A.A,{variant:"outlined",sx:{mb:3},children:(0,_.jsxs)(j.A,{children:[(0,_.jsx)(u.A,{variant:"h5",gutterBottom:!0,children:null===p||void 0===p?void 0:p.title}),(0,_.jsxs)(u.A,{variant:"subtitle1",color:"text.secondary",gutterBottom:!0,children:["\ud83d\udcda ",null===p||void 0===p?void 0:p.unitName]}),(null===p||void 0===p?void 0:p.course)&&(0,_.jsxs)(u.A,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:["Course: ",p.course.code," - ",p.course.name]}),(0,_.jsx)(u.A,{variant:"body1",sx:{mb:2},children:null===p||void 0===p?void 0:p.description}),(0,_.jsx)(y.A,{sx:{my:2}}),(0,_.jsxs)(o.A,{sx:{display:"flex",gap:4,mb:2,flexWrap:"wrap"},children:[(0,_.jsxs)(u.A,{variant:"body2",children:[(0,_.jsx)("strong",{children:"\ud83d\udcca Total Marks:"})," ",null===p||void 0===p?void 0:p.totalMarks]}),(0,_.jsxs)(u.A,{variant:"body2",children:[(0,_.jsx)("strong",{children:"\u23f1\ufe0f Duration:"})," ",null===p||void 0===p?void 0:p.duration," minutes"]}),(0,_.jsxs)(u.A,{variant:"body2",children:[(0,_.jsx)("strong",{children:"\ud83d\udcc5 Due:"})," ",(V=null===p||void 0===p?void 0:p.dueDate,new Date(V).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}))]})]}),(null===p||void 0===p?void 0:p.instructions)&&(0,_.jsxs)(o.A,{sx:{mt:2},children:[(0,_.jsx)(u.A,{variant:"subtitle2",gutterBottom:!0,children:"\ud83d\udccb Instructions:"}),(0,_.jsx)(u.A,{variant:"body2",sx:{p:2,bgcolor:"grey.50",borderRadius:1,border:1,borderColor:"grey.200"},children:p.instructions})]})]})}),(0,_.jsxs)(J.A,{severity:"warning",sx:{mb:3},children:[(0,_.jsx)(u.A,{variant:"subtitle2",gutterBottom:!0,children:"\ud83d\udd12 Security Notice:"}),(0,_.jsxs)(u.A,{variant:"body2",children:["\u2022 Screenshots and screen recording are disabled",(0,_.jsx)("br",{}),"\u2022 Right-click and developer tools are blocked",(0,_.jsx)("br",{}),"\u2022 Switching tabs or windows will trigger warnings",(0,_.jsx)("br",{}),"\u2022 Your viewing session is being monitored",(0,_.jsx)("br",{}),"\u2022 Time limit will be strictly enforced",(0,_.jsx)("br",{}),"\u2022 Copying and saving are disabled"]})]}),(0,_.jsx)(J.A,{severity:"info",children:(0,_.jsxs)(u.A,{variant:"body2",children:[(0,_.jsx)("strong",{children:"Ready to start?"})," Once you begin viewing, the timer will start and security measures will be activated. Make sure you're in a quiet environment and won't be interrupted."]})})]})}),!C&&(0,_.jsxs)(te.A,{sx:{p:3},children:[(0,_.jsx)(h.A,{onClick:i,color:"inherit",children:"Cancel"}),(0,_.jsx)(h.A,{onClick:async()=>{try{m(!0);const e=(await H.A.get("/api/secure-images/".concat(t,"/").concat(n),{responseType:"blob"})).data,s=URL.createObjectURL(e);v(s),P(!0),await H.A.post("/api/secure-images/log-access",{assessmentId:n,assessmentType:t,action:"start_viewing",timestamp:(new Date).toISOString()})}catch(f){console.error("Error loading secure image:",f),w("Failed to load assessment image. Please try again or contact support.")}finally{m(!1)}},variant:"contained",startIcon:(0,_.jsx)(ae.A,{}),color:"primary",disabled:d||!(null!==p&&void 0!==p&&p.hasFile),children:"Start Secure Viewing"})]})]}),(0,_.jsx)(oe.A,{open:W,autoHideDuration:4e3,onClose:()=>z(!1),anchorOrigin:{vertical:"top",horizontal:"center"},children:(0,_.jsx)(J.A,{onClose:()=>z(!1),severity:"error",sx:{width:"100%"},icon:(0,_.jsx)(N.A,{}),children:D})})]}):null;var V},de=()=>{var e,t,n;const[G,J]=(0,r.useState)(null),[X,Q]=(0,r.useState)([]),[Z,$]=(0,r.useState)(!0),[ee,te]=(0,r.useState)(0),[ne,re]=(0,r.useState)(1),[oe,ae]=(0,r.useState)({}),[le,de]=(0,r.useState)(null),[ue,xe]=(0,r.useState)(!1),[he,me]=(0,r.useState)(1),[pe,ye]=(0,r.useState)(!1),[ge,Ae]=(0,r.useState)(null),[je,be]=(0,r.useState)(!1),[ve,fe]=(0,r.useState)(null),{id:we}=(0,V.g)(),Se=(0,i.A)();(0,r.useEffect)(()=>{ke()},[we]);const ke=async()=>{try{$(!0);const t=await H.A.get("/api/courses/".concat(we));J(t.data.course);try{const e=await H.A.get("/api/student/course/".concat(we,"/content"));Q(e.data.content||[]),ae(e.data.subscriptions||{}),de(e.data.subscriptionInfo),console.log("\ud83d\udcda Loaded approved content:",e.data)}catch(e){console.log("No approved content found for this course"),Q([])}}catch(t){console.error("Error fetching course data:",t),setError("Failed to load course data. Please try again later."),J(null),Q([])}finally{$(!1)}},Ce=e=>{switch(e){case"video":return(0,_.jsx)(C.A,{});case"notes":default:return(0,_.jsx)(P.A,{});case"cats":return(0,_.jsx)(I.A,{});case"assignments":return(0,_.jsx)(E.A,{});case"pastExams":return(0,_.jsx)(D.A,{});case"youtube":return(0,_.jsx)(R.A,{})}},Pe=e=>{switch(e){case"video":return Se.palette.primary.main;case"notes":return Se.palette.secondary.main;case"cats":return Se.palette.warning.main;case"assignments":return Se.palette.success.main;case"pastExams":return Se.palette.info.main;case"youtube":return"#ff0000";default:return Se.palette.grey[500]}},Ie=e=>{switch(e){case"video":return"Lecture Video";case"notes":return"PDF Notes";case"cats":return"CAT";case"assignments":return"Assignment";case"pastExams":return"Past Exam";case"youtube":return"YouTube Video";default:return e}},Ee=X.filter(e=>{var t;return(null===(t=e.unit)||void 0===t?void 0:t.year)===ne}),De=e=>oe[e]||!1,Re=e=>{me(e),xe(!0)};return Z?(0,_.jsx)(o.A,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"60vh",children:(0,_.jsx)(a.A,{})}):(0,_.jsxs)(o.A,{children:[(0,_.jsx)(o.A,{sx:{background:"linear-gradient(135deg, ".concat(Se.palette.primary.main," 0%, ").concat(Se.palette.primary.dark," 100%)"),color:"white",py:6,position:"relative",overflow:"hidden"},children:(0,_.jsx)(l.A,{maxWidth:"lg",children:(0,_.jsx)(q.P.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.8},children:(0,_.jsxs)(c.Ay,{container:!0,spacing:4,alignItems:"center",children:[(0,_.jsxs)(c.Ay,{item:!0,xs:12,md:8,children:[(0,_.jsxs)(o.A,{sx:{display:"flex",alignItems:"center",mb:3},children:[(0,_.jsx)(d.A,{sx:{width:70,height:70,bgcolor:"rgba(255,255,255,0.2)",mr:3},children:(0,_.jsx)(D.A,{sx:{fontSize:35}})}),(0,_.jsxs)(o.A,{children:[(0,_.jsx)(u.A,{variant:"h3",component:"h1",sx:{fontWeight:700,mb:1},children:null===G||void 0===G?void 0:G.name}),(0,_.jsxs)(o.A,{sx:{display:"flex",alignItems:"center",gap:2},children:[(0,_.jsx)(x.A,{label:null===G||void 0===G?void 0:G.code,sx:{bgcolor:"rgba(255,255,255,0.2)",color:"white",fontWeight:600}}),(0,_.jsx)(x.A,{label:null===G||void 0===G?void 0:G.department,sx:{bgcolor:Se.palette.secondary.main,color:"white",fontWeight:600}})]})]})]}),(0,_.jsx)(u.A,{variant:"h6",sx:{mb:3,opacity:.9,lineHeight:1.6},children:null===G||void 0===G?void 0:G.description}),(0,_.jsxs)(o.A,{sx:{display:"flex",alignItems:"center",gap:3,mb:3},children:[(0,_.jsxs)(o.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,_.jsx)(W.A,{sx:{fontSize:20}}),(0,_.jsxs)(u.A,{variant:"body1",children:[null===G||void 0===G?void 0:G.duration.years," Years"]})]}),(0,_.jsxs)(o.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,_.jsx)(z.A,{sx:{fontSize:20}}),(0,_.jsxs)(u.A,{variant:"body1",children:[null===G||void 0===G?void 0:G.totalStudents," Students"]})]}),(0,_.jsxs)(o.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,_.jsx)(L.A,{sx:{fontSize:20,color:"#ffc107"}}),(0,_.jsxs)(u.A,{variant:"body1",children:[null===G||void 0===G?void 0:G.rating," Rating"]})]})]}),(0,_.jsxs)(o.A,{sx:{display:"flex",gap:2},children:[(0,_.jsx)(h.A,{variant:"contained",size:"large",startIcon:(0,_.jsx)(U.A,{}),sx:{bgcolor:Se.palette.secondary.main,"&:hover":{bgcolor:Se.palette.secondary.dark}},children:"Start Learning"}),(0,_.jsx)(m.A,{sx:{color:"white"},children:(0,_.jsx)(T.A,{})}),(0,_.jsx)(m.A,{sx:{color:"white"},children:(0,_.jsx)(M.A,{})})]})]}),(0,_.jsx)(c.Ay,{item:!0,xs:12,md:4,children:(0,_.jsxs)(p.A,{elevation:8,sx:{p:3,bgcolor:"rgba(255,255,255,0.95)",backdropFilter:"blur(10px)",borderRadius:3},children:[(0,_.jsx)(u.A,{variant:"h6",color:"primary",gutterBottom:!0,sx:{fontWeight:600},children:"Course Progress"}),(0,_.jsx)(y.A,{sx:{mb:2}}),(0,_.jsxs)(o.A,{sx:{mb:3},children:[(0,_.jsxs)(o.A,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[(0,_.jsx)(u.A,{variant:"body2",color:"text.secondary",children:"Completion"}),(0,_.jsxs)(u.A,{variant:"body2",sx:{fontWeight:600},children:[null===G||void 0===G?void 0:G.completionRate,"%"]})]}),(0,_.jsx)(g.A,{variant:"determinate",value:(null===G||void 0===G?void 0:G.completionRate)||0,sx:{height:8,borderRadius:4}})]}),(0,_.jsxs)(o.A,{sx:{display:"flex",justifyContent:"space-between",mb:2},children:[(0,_.jsx)(u.A,{variant:"body2",color:"text.secondary",children:"Resources"}),(0,_.jsx)(u.A,{variant:"body2",sx:{fontWeight:600},children:X.length})]}),(0,_.jsxs)(o.A,{sx:{display:"flex",justifyContent:"space-between",mb:2},children:[(0,_.jsx)(u.A,{variant:"body2",color:"text.secondary",children:"Institution"}),(0,_.jsx)(u.A,{variant:"body2",sx:{fontWeight:600},children:(null===G||void 0===G||null===(e=G.institution)||void 0===e?void 0:e.shortName)||(null===G||void 0===G||null===(t=G.institution)||void 0===t?void 0:t.name)||"N/A"})]})]})})]})})})}),(0,_.jsxs)(l.A,{maxWidth:"lg",sx:{py:6},children:[(0,_.jsxs)(o.A,{sx:{mb:4},children:[(0,_.jsx)(u.A,{variant:"h4",component:"h2",gutterBottom:!0,sx:{fontWeight:600,mb:3},children:"Course Content"}),(0,_.jsx)(o.A,{sx:{display:"flex",gap:2,mb:4,flexWrap:"wrap"},children:Array.from({length:(null===G||void 0===G||null===(n=G.duration)||void 0===n?void 0:n.years)||3},(e,t)=>t+1).map(e=>(0,_.jsxs)(h.A,{variant:ne===e?"contained":"outlined",onClick:()=>re(e),sx:{minWidth:120,py:1.5,fontWeight:600,borderRadius:3},children:["Year ",e]},e))})]}),(0,_.jsxs)(o.A,{sx:{mb:6},children:[(0,_.jsxs)(u.A,{variant:"h5",component:"h3",gutterBottom:!0,sx:{fontWeight:600,mb:3},children:["Course Units - Year ",ne]}),null!==G&&void 0!==G&&G.units&&G.units.length>0?(0,_.jsx)(c.Ay,{container:!0,spacing:2,children:[1,2].map(e=>{const t=G.units.filter(t=>t.year===ne&&t.semester===e);return(0,_.jsx)(c.Ay,{item:!0,xs:12,md:6,children:(0,_.jsxs)(p.A,{sx:{p:3},children:[(0,_.jsxs)(u.A,{variant:"h6",color:"primary",gutterBottom:!0,children:["Semester ",e]}),0===t.length?(0,_.jsx)(u.A,{variant:"body2",color:"text.secondary",children:"No units available for this semester"}):(0,_.jsx)(o.A,{sx:{display:"flex",flexDirection:"column",gap:2},children:t.map(e=>(0,_.jsx)(A.A,{variant:"outlined",children:(0,_.jsxs)(j.A,{sx:{p:2},children:[(0,_.jsxs)(o.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:1},children:[(0,_.jsx)(u.A,{variant:"subtitle1",sx:{fontWeight:600},children:e.unitCode}),(0,_.jsx)(x.A,{label:"".concat(e.creditHours," CH"),size:"small",color:"primary"})]}),(0,_.jsx)(u.A,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:e.unitName}),e.description&&(0,_.jsx)(u.A,{variant:"body2",sx:{mt:1},children:e.description}),e.prerequisites&&e.prerequisites.length>0&&(0,_.jsx)(o.A,{sx:{mt:1},children:(0,_.jsxs)(u.A,{variant:"caption",color:"warning.main",children:["Prerequisites: ",e.prerequisites.join(", ")]})})]})},e._id))})]})},e)})}):(0,_.jsxs)(p.A,{sx:{p:4,textAlign:"center"},children:[(0,_.jsxs)(u.A,{variant:"h6",color:"text.secondary",children:["No units available for Year ",ne," yet."]}),(0,_.jsx)(u.A,{variant:"body2",color:"text.secondary",sx:{mt:1},children:"Units will appear here once they are added by administrators."})]})]}),(0,_.jsx)(o.A,{sx:{mb:4},children:(0,_.jsxs)(u.A,{variant:"h5",component:"h3",gutterBottom:!0,sx:{fontWeight:600,mb:3},children:["Learning Resources - Year ",ne]})}),(0,_.jsx)(c.Ay,{container:!0,spacing:3,children:0===Ee.length?(0,_.jsx)(c.Ay,{item:!0,xs:12,children:(0,_.jsx)(p.A,{sx:{p:4,textAlign:"center"},children:(0,_.jsxs)(u.A,{variant:"h6",color:"text.secondary",children:["No resources available for Year ",ne," yet."]})})}):Ee.map(e=>{var t,n,r,i;return(0,_.jsx)(c.Ay,{item:!0,xs:12,children:(0,_.jsx)(q.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:(0,_.jsx)(A.A,{sx:{mb:3,overflow:"hidden",border:e.isPremium?"2px solid #ffa726":"1px solid #e0e0e0"},children:(0,_.jsxs)(j.A,{sx:{p:0},children:[(0,_.jsxs)(o.A,{sx:{p:3,pb:2},children:[(0,_.jsxs)(o.A,{sx:{display:"flex",alignItems:"flex-start",mb:2},children:[(0,_.jsx)(d.A,{sx:{bgcolor:(0,b.X4)(Pe(e.type),.1),color:Pe(e.type),width:50,height:50,mr:2},children:Ce(e.type)}),(0,_.jsxs)(o.A,{sx:{flexGrow:1},children:[(0,_.jsxs)(o.A,{sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[(0,_.jsx)(u.A,{variant:"h6",component:"h3",sx:{fontWeight:600},children:e.title}),e.isPremium&&(0,_.jsx)(x.A,{label:"PREMIUM",size:"small",color:"warning",icon:(0,_.jsx)(K.A,{})})]}),(0,_.jsxs)(u.A,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:[null===(t=e.unit)||void 0===t?void 0:t.name," \u2022 Year ",null===(n=e.unit)||void 0===n?void 0:n.year," \u2022 Semester ",null===(r=e.unit)||void 0===r?void 0:r.semester]}),e.topic&&(0,_.jsxs)(u.A,{variant:"caption",color:"text.secondary",children:["Topic ",e.topic.number,": ",e.topic.title]})]})]}),(0,_.jsxs)(o.A,{sx:{display:"flex",gap:1,mb:2},children:[(0,_.jsx)(x.A,{label:Ie(e.type),size:"small",sx:{bgcolor:(0,b.X4)(Pe(e.type),.1),color:Pe(e.type),fontWeight:600}}),e.duration&&(0,_.jsx)(x.A,{label:e.duration,size:"small",variant:"outlined"}),e.fileSize&&(0,_.jsx)(x.A,{label:"".concat((e.fileSize/1024/1024).toFixed(1)," MB"),size:"small",variant:"outlined"})]}),e.description&&(0,_.jsx)(u.A,{variant:"body2",color:"text.secondary",sx:{mb:2},children:e.description})]}),"video"===e.type&&e.hasAccess&&e.filename&&(0,_.jsx)(o.A,{sx:{px:3,pb:3},children:(0,_.jsx)(O,{filename:e.filename,backendUrl:"https://eduvault-exms.onrender.com",isPremium:e.isPremium,hasSubscription:De(e.unit.year)})}),"video"===e.type&&!e.hasAccess&&(0,_.jsx)(o.A,{sx:{px:3,pb:3},children:(0,_.jsxs)(p.A,{sx:{p:4,textAlign:"center",bgcolor:"grey.100",border:"2px dashed #ffa726"},children:[(0,_.jsx)(K.A,{sx:{fontSize:64,color:"warning.main",mb:2}}),(0,_.jsx)(u.A,{variant:"h6",gutterBottom:!0,children:"Premium Content"}),(0,_.jsx)(u.A,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Subscribe to access this video lecture"}),(0,_.jsxs)(h.A,{variant:"contained",color:"warning",onClick:()=>Re(e.unit.year),startIcon:(0,_.jsx)(L.A,{}),children:["Subscribe for KSH ",(null===le||void 0===le?void 0:le.price)||100]})]})}),(0,_.jsxs)(o.A,{sx:{p:3,pt:0,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,_.jsxs)(o.A,{sx:{display:"flex",gap:2,flexWrap:"wrap"},children:["notes"===e.type&&e.filename&&(0,_.jsx)(_.Fragment,{children:null!==(i=e.accessRules)&&void 0!==i&&i.canDownload?(0,_.jsx)(h.A,{variant:"contained",size:"small",startIcon:(0,_.jsx)(B.A,{}),onClick:()=>(e=>{var t,n;if(null!==(t=e.accessRules)&&void 0!==t&&t.downloadRequiresSubscription&&!De(e.unit.year))Re(e.unit.year);else if(null!==(n=e.accessRules)&&void 0!==n&&n.canDownload){const t="".concat("https://eduvault-exms.onrender.com","/api/upload/file/").concat(e.filename);window.open(t,"_blank")}})(e),sx:{borderRadius:2},children:"Download PDF"}):(0,_.jsx)(h.A,{variant:"outlined",size:"small",startIcon:(0,_.jsx)(K.A,{}),onClick:()=>Re(e.unit.year),sx:{borderRadius:2},children:"Subscribe to Download"})}),"youtube"===e.type&&e.url&&e.hasAccess&&(0,_.jsx)(h.A,{variant:"contained",size:"small",startIcon:(0,_.jsx)(R.A,{}),href:e.url,target:"_blank",sx:{borderRadius:2},children:"Watch on YouTube"}),"assignments"===e.type&&e.filename&&(0,_.jsx)(h.A,{variant:"contained",size:"small",startIcon:(0,_.jsx)(E.A,{}),href:"".concat("https://eduvault-exms.onrender.com","/api/upload/file/").concat(e.filename),target:"_blank",sx:{borderRadius:2,bgcolor:"success.main"},children:"Download Assignment (Free)"}),["cats","pastExams"].includes(e.type)&&e.filename&&(0,_.jsx)(_.Fragment,{children:e.hasAccess?(0,_.jsxs)(h.A,{variant:"contained",size:"small",startIcon:(0,_.jsx)(N.A,{}),onClick:()=>(e=>{if(console.log("\ud83d\udd0d CoursePage - handleSecureImageView called with:",e),["cats","pastExams"].includes(e.type)){let t=e._id||e.id||"507f1f77bcf86cd799439011";"string"!==typeof t||!t.includes("-")&&24===t.length||(t="507f1f77bcf86cd799439011");const n=(0,s.A)((0,s.A)({},e),{},{_id:t,id:t});console.log("\ud83d\udd27 Using cleaned ID:",t),fe(n),be(!0)}})(e),sx:{borderRadius:2,bgcolor:"warning.main"},children:["\ud83d\udd12 View ",Ie(e.type)," (Secure)"]}):(0,_.jsx)(h.A,{variant:"outlined",size:"small",startIcon:(0,_.jsx)(K.A,{}),onClick:()=>Re(e.unit.year),sx:{borderRadius:2},children:"Subscribe to Access"})}),De(e.unit.year)&&(0,_.jsx)(x.A,{label:"Premium Active",color:"success",size:"small",icon:(0,_.jsx)(F.A,{})}),(0,_.jsx)(m.A,{size:"small",children:(0,_.jsx)(T.A,{})})]}),(0,_.jsxs)(u.A,{variant:"caption",color:"text.secondary",children:["Uploaded: ",new Date(e.uploadDate).toLocaleDateString()]})]})]})})})},e.id)})}),(0,_.jsxs)(o.A,{sx:{mt:6},children:[(0,_.jsx)(u.A,{variant:"h5",component:"h2",gutterBottom:!0,sx:{fontWeight:600,mb:3},children:"Course Information"}),(null===G||void 0===G?void 0:G.entryRequirements)&&(0,_.jsxs)(v.A,{children:[(0,_.jsx)(f.A,{expandIcon:(0,_.jsx)(Y.A,{}),children:(0,_.jsx)(u.A,{variant:"h6",sx:{fontWeight:600},children:"Entry Requirements"})}),(0,_.jsx)(w.A,{children:(0,_.jsx)(u.A,{variant:"body2",children:G.entryRequirements})})]}),(null===G||void 0===G?void 0:G.careerProspects)&&G.careerProspects.length>0&&(0,_.jsxs)(v.A,{children:[(0,_.jsx)(f.A,{expandIcon:(0,_.jsx)(Y.A,{}),children:(0,_.jsx)(u.A,{variant:"h6",sx:{fontWeight:600},children:"Career Prospects"})}),(0,_.jsx)(w.A,{children:(0,_.jsx)(o.A,{component:"ul",sx:{pl:2},children:G.careerProspects.map((e,t)=>(0,_.jsx)(o.A,{component:"li",sx:{mb:1},children:(0,_.jsx)(u.A,{variant:"body2",children:e})},t))})})]}),(null===G||void 0===G?void 0:G.description)&&(0,_.jsxs)(v.A,{children:[(0,_.jsx)(f.A,{expandIcon:(0,_.jsx)(Y.A,{}),children:(0,_.jsx)(u.A,{variant:"h6",sx:{fontWeight:600},children:"Course Description"})}),(0,_.jsx)(w.A,{children:(0,_.jsx)(u.A,{variant:"body2",children:G.description})})]})]})]}),(0,_.jsx)(se,{open:ue,onClose:()=>xe(!1),courseId:we,courseName:null===G||void 0===G?void 0:G.name,year:he,onSubscriptionSuccess:e=>{ae(t=>(0,s.A)((0,s.A)({},t),{},{[e.year]:!0})),ke()}}),(0,_.jsx)(S.A,{open:pe,onClose:()=>ye(!1),maxWidth:"lg",fullWidth:!0,PaperProps:{sx:{height:"90vh"}},children:(0,_.jsx)(k.A,{sx:{p:0},children:ge&&(0,_.jsx)(ie,{filename:ge.filename,contentType:"cats"===ge.type||"pastExams"===ge.type?"pdf":"image",title:ge.title,backendUrl:"https://eduvault-exms.onrender.com",preventScreenshot:!0,preventRecording:!0,onClose:()=>ye(!1)})})}),ve&&(0,_.jsx)(ce,{type:ve.type,id:ve._id||ve.id,open:je,onClose:()=>{be(!1),fe(null)}})]})}}}]);